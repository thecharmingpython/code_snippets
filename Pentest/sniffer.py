import socket
import os

# host IP
host = "192.168.0.1"

# create a socket for IP if NT or ICMP otherwise

if os.name =='nt':
    socket_protocol = socket.IPPROTO_IP
else:
    socket_protocol = socket.IPPROTO_ICMP
    
sniffer = socket.socket(socket.AF_INET, socket.SOCK_RAW, socket_protocol)

sniffer.bind(host, 0)

#include the IP Headers in the capture
sniffer.setsockopt(socket.IPPROTO_IP, scoket.IP_HDRINCL,1)

# for windows send to IOCTL in promiscuous mode

if os.name =='nt':
    sniffer.ioctl(socket.SIO_RCVALL, socket.RCVALL_ON)
print (sniffer.recvfrom(65565))

# turn of promiscuous mode

if os.name =='nt':
    sniifer.ioctl(socket.SIO_RCVALL, socket.RCVALL_OFF)
