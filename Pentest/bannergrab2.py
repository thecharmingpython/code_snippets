import socket
import re 

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
 

def pscan(host, port):
    try:
        s.connect((host, port))
        return True
        
    except:
        return False

def bannergrab(host, port, socket):
    banner = (socket.recv(1024).decode())
    return banner 


host = "target1"

for port in range(22010,22030):

    if pscan(host,port):
        print ("port",port, " is open")
        break

banner = bannergrab(host,port,s)
print (banner)
s.close()




